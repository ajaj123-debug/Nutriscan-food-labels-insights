# Deployment Guide for Render

## Prerequisites
- GitHub repository with your Django project
- Render account (free tier available)

## Step 1: Prepare Your Repository

1. Make sure all changes are committed and pushed to GitHub
2. Verify that `render.yaml` is in your root directory
3. Ensure `requirements.txt` contains all necessary packages

## Step 2: Deploy on Render

### Option A: Using render.yaml (Recommended)
1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click "New +" and select "Blueprint"
3. Connect your GitHub repository
4. Render will automatically detect `render.yaml` and configure everything
5. Click "Apply" to deploy

### Option B: Manual Deployment
1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click "New +" and select "Web Service"
3. Connect your GitHub repository
4. Configure the service:
   - **Name**: `nutriscan-food-labels-insights`
   - **Environment**: `Python 3`
   - **Build Command**: `pip install -r requirements.txt && python manage.py collectstatic --noinput && python manage.py migrate`
   - **Start Command**: `gunicorn ocr_project_pr1.wsgi:application`

## Step 3: Set Environment Variables

In your Render service, set these environment variables:

```
ENVIRONMENT=production
DEBUG=false
SECRET_KEY=<auto-generated-by-render>
GOOGLE_OAUTH2_KEY=990390516510-i43uhpe18le8vcdgeu1oino13nqfs821.apps.googleusercontent.com
GOOGLE_OAUTH2_SECRET=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
```

## Step 4: Database Setup

1. Create a new PostgreSQL database in Render
2. Copy the `DATABASE_URL` from the database settings
3. Add it to your service environment variables

## Step 5: Google OAuth Configuration

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Update your OAuth 2.0 redirect URI to:
   `https://your-app-name.onrender.com/social-auth/complete/google-oauth2/`

## Step 6: Verify Deployment

1. Check that your app is running at the provided URL
2. Test the login functionality
3. Verify that the navbar shows correctly with authentication

## Troubleshooting

### Navbar Issues
- Check that `DEBUG=false` in production
- Verify OAuth redirect URIs are correct
- Check browser console for JavaScript errors

### Static Files
- Ensure `python manage.py collectstatic` runs during build
- Check that `STATIC_ROOT` is properly configured

### Database Issues
- Verify `DATABASE_URL` is set correctly
- Check that migrations run successfully during build

## Environment Variables Reference

| Variable | Description | Production Value |
|----------|-------------|------------------|
| `ENVIRONMENT` | Environment type | `production` |
| `DEBUG` | Debug mode | `false` |
| `SECRET_KEY` | Django secret key | Auto-generated |
| `DATABASE_URL` | Database connection | From Render DB |
| `GOOGLE_OAUTH2_KEY` | Google OAuth client ID | Your OAuth key |
| `GOOGLE_OAUTH2_SECRET` | Google OAuth secret | Your OAuth secret |

## Local Development

For local development, create a `.env` file:

```bash
DEBUG=true
ENVIRONMENT=development
SECRET_KEY=your-local-secret-key
DATABASE_URL=sqlite:///db.sqlite3
GOOGLE_OAUTH2_KEY=your-google-oauth2-key
GOOGLE_OAUTH2_SECRET=your-google-oauth2-secret
```

## Security Notes

- Never commit `.env` files to version control
- Use environment variables for sensitive data
- Enable HTTPS in production (Render does this automatically)
- Regularly update dependencies for security patches
